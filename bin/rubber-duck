#!/usr/bin/env node
'use strict';
/*
* Local Variables:
* mode: Javascript
* End:
* // emacs hint to show this file as Javascript
*/

var colors = require('colors'),
os = require('os'),
readline = require('readline'),
rubberduck = require('..');

var prompt = '> ';

var quits = {
  'bye' : 'See ya',
  'exit' : 'Good luck',
  'quit' : 'OK bye',
  'thanks' : 'Nice talking to you'
}

process.stdin.setEncoding('utf8');
process.stdout.setEncoding('utf8');

var terminal = readline.createInterface({
  input: process.stdin,
  output: process.stdout
})

function quit(message){
  terminal.write(message.yellow + os.EOL);
  terminal.close();
  process.exit(0);
}


function response(question){

  var lowered = question.toLowerCase();
  if(quits.hasOwnProperty(lowered)) return quit(quits[lowered] + os.EOL);
  rubberduck.ask(question, function(err, result){
    if(err) result = 'I didn\'t understand that, can you say it clearer? ';
    terminal.question((prompt + result).yellow + os.EOL, response);
  });
}

terminal.question((prompt + 'Whatcha working on? '.yellow + os.EOL), response);

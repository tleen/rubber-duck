#!/usr/bin/env node
'use strict';
/*
* Local Variables:
* mode: Javascript
* End:
* // emacs hint to show this file as Javascript
*/

var os = require('os'),
readline = require('readline'),
rubberduck = require('..');

var quits = {
  'bye' : 'see ya',
  'thanks' : 'Nice talking to you'
}

var terminal = readline.createInterface({
  input: process.stdin,
  output: process.stdout
});

terminal.setPrompt('> ');

function quit(message){
  terminal.write(message + os.EOL);
  terminal.close();
  process.exit(0);
}

process.on('SIGINT', quit);

function response(question){

  var lowered = question.toLowerCase();
  if(quits.hasOwnProperty(lowered)) return quit(quits[lowered]);
  
  rubberduck.ask(question, function(err, result){
    if(err) result = 'I didn\'t understand that, can you say it clearer? ';
    terminal.question(result + ' ', response);
  });
}

terminal.question('Whatcha working on? ', response);
